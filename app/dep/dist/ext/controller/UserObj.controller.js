sap.ui.define(["sap/ui/core/mvc/ControllerExtension"],function(e){"use strict";var r="divya.sharma@peolsolutions.com";return e.extend("dep.ext.controller.UserObj",{override:{onInit:function(){debugger},routing:{onBeforeBinding:async function(){debugger;var e=this.base.getExtensionAPI().getModel();if(!e){console.error("Model is not available.");return}var t;if(typeof e.getServiceUrl==="function"){t=e.getServiceUrl();console.log("Service URL:",t)}else{console.error("Unable to determine the service URL.");return}try{const e=await new Promise((e,r)=>{jQuery.ajax({url:t+"/authorisation",method:"GET",dataType:"json",success:function(r){e(r)},error:function(e,t,n){r(new Error(t+": "+n))}})});const c=await new Promise((e,r)=>{jQuery.ajax({url:t+"/Department",method:"GET",dataType:"json",success:function(r){e(r)},error:function(e,t,n){r(new Error(t+": "+n))}})});debugger;console.log("Fetched auth data:",e);console.log("Fetched dept data:",c);if(e&&e.value&&Array.isArray(e.value)&&c&&c.value&&Array.isArray(c.value)){var n=e.value.find(e=>e.Email===r);if(!n){debugger;console.error("User not found in authorisation data.");return}var o=n.role;console.log(`User Role: ${o}`);var i=this.getView().getBindingContext();var a=i.getPath();var s=null;var u=a.match(/DepartmentID='([^']+)'/);if(u&&u[1]){s=u[1]}if(o!==s&&o!=="Admin"){this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")}).forEach(function(e){if(e.getId().includes("Edit")||e.getId().includes("Delete")||e.getId().includes("Create")){e.setVisible(false)}})}if(o!=="Admin"){debugger;this.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Input")&&e.getBindingPath("value")==="DepartmentName"}).forEach(function(e){e.setEditable(false)})}}}catch(e){console.error("Error fetching data",e)}}}}})});
//# sourceMappingURL=UserObj.controller.js.map